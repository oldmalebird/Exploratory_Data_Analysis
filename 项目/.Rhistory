value.var = 'median_friend_count')
head(pf.fc_by_age_gender.wide)
library(tidyr)
pf.fc_by_age_gender.wide <- subset(pf.fc_by_age_gender[c('age', 'gender', 'median_friend_count')],!is.na(gender)) %>%
spread(gender, median_friend_count) %>%
mutate(ratio = male / female)
head(pf.fc_by_age_gender.wide)
ggplot(aes(x = age,y = female / male),
data = pf.fc_by_age_gender.wide) +
geom_line() +
geom_hline(yintercept = 1, alpha = 0.3, linetype = 2)
pf$year_joined <- floor(2014 - pf$tenure/365)
summary(pf$year_joined)
table(pf$year_joined)
pf$year_joined.bucket <- cut(pf$year_joined,
c(2004, 2009, 2011, 2012, 2014))
pf$year_joined.bucket <- cut(pf$year_joined,
c(2004, 2009, 2011, 2012, 2014))
table(pf$year_joined.bucket)
table(pf$year_joined.bucket, useNA ='ifany')
ggplot(aes(x = age, y = friend_count),
data = subset(pf, !is.na(year_joined.bucket))) +
geom_line(aes(color = year_joined.bucket),
stat = 'summary', fun.y = median)
ggplot(aes(x = age, y = friend_count),
data = subset(pf, !is.na(year_joined.bucket))) +
geom_line(aes(color = year_joined.bucket),
stat = 'summary',
fun.y = mean) +
geom_line(stat = 'summary', fun.y = mean, linetype = 2)
with(subset(pf, tenure >= 1), summary(friend_count / tenure))
ggplot(aes(x = tenure, y = friendships_initiated/tenure),
data = subset(pf, tenure >= 1)) +
geom_line(aes(color = year_joined.bucket))
ggplot(aes(x = tenure, y = friendships_initiated / tenure),
data = subset(pf, tenure >= 1)) +
geom_line(aes(color = year_joined.bucket),
stat = 'summary',
fun.y = mean)
ggplot(aes(x = 7 * round(tenure / 7), y = friendships_initiated / tenure),
data = subset(pf, tenure > 0)) +
geom_line(aes(color = year_joined.bucket),
stat = "summary",
fun.y = mean)
ggplot(aes(x = 30 * round(tenure / 30), y = friendships_initiated / tenure),
data = subset(pf, tenure > 0)) +
geom_line(aes(color = year_joined.bucket),
stat = "summary",
fun.y = mean)
ggplot(aes(x = 90 * round(tenure / 90), y = friendships_initiated / tenure),
data = subset(pf, tenure > 0)) +
geom_line(aes(color = year_joined.bucket),
stat = "summary",
fun.y = mean)
ggplot(aes(x = volatile.acidity, y = citric.acid, color = quality),
data = redwine) +
geom_point(alpha = 0.2) +
ylim(0, quantile(redwine$citric.acid, 0.99)) +
scale_y_sqrt() +
geom_smooth(method = 'lm', se=FALSE) +
facet_wrap( ~ quality)
ggplot(aes(x = alcohol, y = density, color = quality),
data = redwine) +
geom_point(alpha = 0.2) +
scale_x_log10() +
geom_smooth(method = 'lm', se=FALSE) +
facet_wrap( ~ quality)
ggplot(aes(x = alcohol, y = density, color = quality),
data = redwine) +
geom_point(alpha = 0.2) +
scale_x_log10() +
geom_smooth(method = 'lm', se=FALSE)
ggplot(aes(x = alcohol, y = density, color = quality),
data = redwine) +
geom_point(alpha = 0.2) +
scale_x_log10() +
geom_smooth(method = 'lm', se=FALSE)
ggplot(aes(x = pH, y = citric.acid, color = quality),
data = redwine) +
geom_point(alpha = 0.2) +
ylim(0, quantile(redwine$citric.acid, 0.99)) +
scale_y_sqrt() +
geom_smooth(method = 'lm', se=FALSE) +
facet_wrap( ~ quality)
ggplot(aes(x = pH, y = sulphates, color = quality),
data = redwine) +
geom_point(alpha = 0.2) +
ylim(0, quantile(redwine$sulphates, 0.99)) +
scale_y_sqrt() +
geom_smooth(method = 'lm', se=FALSE) +
facet_wrap( ~ quality)
ggplot(aes(x = total.sulfur.dioxide, y = sulphates, color = quality),
data = redwine) +
geom_point(alpha = 0.2) +
ylim(0, quantile(redwine$sulphates, 0.99)) +
scale_y_sqrt() +
geom_smooth(method = 'lm', se=FALSE) +
facet_wrap( ~ quality)
ggplot(aes(x = total.sulfur.dioxide, y = sulphates, color = quality),
data = redwine) +
geom_point(alpha = 0.2) +
ylim(0, quantile(redwine$sulphates, 0.99)) +
scale_y_log10() +
geom_smooth(method = 'lm', se=FALSE) +
facet_wrap( ~ quality)
p1 <- ggplot(data=redwine, aes(x = quality, y = alcohol)) +
geom_jitter( alpha = 0.2, color = 'orange') +
geom_boxplot(alpha = 0.2) +
ylim(8, quantile(redwine$alcohol, 0.99)) +
stat_summary(fun.y = "mean",
geom = "point",
shape = 4)
p2 <- ggplot(data=redwine, aes(x = quality, y = volatile.acidity)) +
geom_jitter( alpha = 0.2, color = 'orange') +
geom_boxplot(alpha = 0.2) +
ylim(0, quantile(redwine$volatile.acidity, 0.99)) +
stat_summary(fun.y = "mean",
geom = "point",
shape = 4)
p3 <- ggplot(data=redwine, aes(x = quality, y = citric.acid)) +
geom_jitter( alpha = 0.2, color = 'orange') +
geom_boxplot(alpha = 0.2) +
ylim(0.001, quantile(redwine$citric.acid, 0.99)) +
stat_summary(fun.y = "mean",
geom = "point",
shape = 4)
p4 <- ggplot(data=redwine, aes(x = quality, y = sulphates)) +
geom_jitter( alpha = 0.2, color = 'orange') +
geom_boxplot(alpha = 0.2) +
ylim(0, quantile(redwine$sulphates, 0.99)) +
stat_summary(fun.y = "mean",
geom = "point",
shape = 4)
grid.arrange(p1, p2, p3, p4, ncol = 2)
p1 <- ggplot(data=redwine, aes(x = quality, y = alcohol)) +
geom_jitter( alpha = 0.2, color = 'orange') +
geom_boxplot(alpha = 0.2) +
ylim(8, quantile(redwine$alcohol, 0.99)) +
stat_summary(fun.y = "mean",
geom = "point",
shape = 4) +
labs(title = 'alcohol by quality')
p2 <- ggplot(data=redwine, aes(x = quality, y = volatile.acidity)) +
geom_jitter( alpha = 0.2, color = 'orange') +
geom_boxplot(alpha = 0.2) +
ylim(0, quantile(redwine$volatile.acidity, 0.99)) +
stat_summary(fun.y = "mean",
geom = "point",
shape = 4)
p3 <- ggplot(data=redwine, aes(x = quality, y = citric.acid)) +
geom_jitter( alpha = 0.2, color = 'orange') +
geom_boxplot(alpha = 0.2) +
ylim(0.001, quantile(redwine$citric.acid, 0.99)) +
stat_summary(fun.y = "mean",
geom = "point",
shape = 4)
p4 <- ggplot(data=redwine, aes(x = quality, y = sulphates)) +
geom_jitter( alpha = 0.2, color = 'orange') +
geom_boxplot(alpha = 0.2) +
ylim(0, quantile(redwine$sulphates, 0.99)) +
stat_summary(fun.y = "mean",
geom = "point",
shape = 4)
grid.arrange(p1, p2, p3, p4, ncol = 2)
p1 <- ggplot(data=redwine, aes(x = quality, y = alcohol)) +
geom_jitter( alpha = 0.2, color = 'orange') +
geom_boxplot(alpha = 0.2) +
ylim(8, quantile(redwine$alcohol, 0.99)) +
stat_summary(fun.y = "mean",
geom = "point",
shape = 4) +
labs(title = 'alcohol by quality')
p2 <- ggplot(data=redwine, aes(x = quality, y = volatile.acidity)) +
geom_jitter( alpha = 0.2, color = 'orange') +
geom_boxplot(alpha = 0.2) +
ylim(0, quantile(redwine$volatile.acidity, 0.99)) +
stat_summary(fun.y = "mean",
geom = "point",
shape = 4) +
labs(title = 'volatile acidity by quality')
p3 <- ggplot(data=redwine, aes(x = quality, y = citric.acid)) +
geom_jitter( alpha = 0.2, color = 'orange') +
geom_boxplot(alpha = 0.2) +
ylim(0.001, quantile(redwine$citric.acid, 0.99)) +
stat_summary(fun.y = "mean",
geom = "point",
shape = 4) +
labs(title = 'citric acid by quality')
p4 <- ggplot(data=redwine, aes(x = quality, y = sulphates)) +
geom_jitter( alpha = 0.2, color = 'orange') +
geom_boxplot(alpha = 0.2) +
ylim(0, quantile(redwine$sulphates, 0.99)) +
stat_summary(fun.y = "mean",
geom = "point",
shape = 4) +
labs(title = 'sulphates by quality')
grid.arrange(p1, p2, p3, p4, ncol = 2)
p1 <- ggplot(data=redwine, aes(x = quality, y = alcohol)) +
geom_jitter( alpha = 0.2, color = 'orange') +
geom_boxplot(alpha = 0.2) +
ylim(8, quantile(redwine$alcohol, 0.99)) +
scale_y_log10() +
stat_summary(fun.y = "mean",
geom = "point",
shape = 4) +
labs(title = 'alcohol by quality')
p2 <- ggplot(data=redwine, aes(x = quality, y = volatile.acidity)) +
geom_jitter( alpha = 0.2, color = 'orange') +
geom_boxplot(alpha = 0.2) +
ylim(0, quantile(redwine$volatile.acidity, 0.99)) +
stat_summary(fun.y = "mean",
geom = "point",
shape = 4) +
labs(title = 'volatile acidity by quality')
p3 <- ggplot(data=redwine, aes(x = quality, y = citric.acid)) +
geom_jitter( alpha = 0.2, color = 'orange') +
geom_boxplot(alpha = 0.2) +
ylim(0.001, quantile(redwine$citric.acid, 0.99)) +
stat_summary(fun.y = "mean",
geom = "point",
shape = 4) +
labs(title = 'citric acid by quality')
p4 <- ggplot(data=redwine, aes(x = quality, y = sulphates)) +
geom_jitter( alpha = 0.2, color = 'orange') +
geom_boxplot(alpha = 0.2) +
ylim(0, quantile(redwine$sulphates, 0.99)) +
stat_summary(fun.y = "mean",
geom = "point",
shape = 4) +
labs(title = 'sulphates by quality')
grid.arrange(p1, p2, p3, p4, ncol = 2)
p1 <- ggplot(data=redwine, aes(x = quality, y = alcohol)) +
geom_jitter( alpha = 0.2, color = 'orange') +
geom_boxplot(alpha = 0.2) +
ylim(8, quantile(redwine$alcohol, 0.99)) +
scale_y_log10() +
stat_summary(fun.y = "mean",
geom = "point",
shape = 4) +
labs(title = 'Alcohol(log10) by Quality')
p2 <- ggplot(data=redwine, aes(x = quality, y = volatile.acidity)) +
geom_jitter( alpha = 0.2, color = 'orange') +
geom_boxplot(alpha = 0.2) +
ylim(0, quantile(redwine$volatile.acidity, 0.99)) +
stat_summary(fun.y = "mean",
geom = "point",
shape = 4) +
labs(title = 'Volatile acidity by Quality')
p3 <- ggplot(data=redwine, aes(x = quality, y = citric.acid)) +
geom_jitter( alpha = 0.2, color = 'orange') +
geom_boxplot(alpha = 0.2) +
ylim(0.001, quantile(redwine$citric.acid, 0.99)) +
stat_summary(fun.y = "mean",
geom = "point",
shape = 4) +
labs(title = 'Citric acid by Quality')
p4 <- ggplot(data=redwine, aes(x = quality, y = sulphates)) +
geom_jitter( alpha = 0.2, color = 'orange') +
geom_boxplot(alpha = 0.2) +
ylim(0.3, quantile(redwine$sulphates, 0.99)) +
scale_y_log10() +
stat_summary(fun.y = "mean",
geom = "point",
shape = 4) +
labs(title = 'Sulphates by Quality')
grid.arrange(p1, p2, p3, p4, ncol = 2)
ggplot(aes(x = alcohol, y = density, color = quality),
data = redwine) +
geom_point(alpha = 0.2) +
scale_x_log10() +
geom_smooth(method = 'lm', se=FALSE) +
labs(title = '')
ggplot(aes(x = alcohol, y = density, color = quality),
data = redwine) +
geom_point(alpha = 0.2) +
scale_x_log10() +
geom_smooth(method = 'lm', se=FALSE) +
labs(title = 'Density by Quality')
ggplot(aes(x = volatile.acidity, y = citric.acid, color = quality),
data = redwine) +
geom_point(alpha = 0.2) +
ylim(0, quantile(redwine$citric.acid, 0.99)) +
scale_y_sqrt() +
geom_smooth(method = 'lm', se=FALSE) +
facet_wrap( ~ quality) +
labs(title = 'Citric Acid by Quality')
m1 <- lm(I(quality)) ~ I(log(alcohol), data = redwine)
m2 <- update(m1, ~ . + volatile.acidity)
m3 <- update(m2, ~ . + citric.acid)
m4 <- update(m3, ~ . + sulphates)
mtable(m1, m2, m3, m4)
install.packages('memisc')
# 加载你最终使用的所有组件
# 在这个代码块的分析中。
# 注意，在这个代码块中，将参数 "echo" 设为假。
# This prevents the code from displaying in the knitted HTML output.这可以避免代码混入 HTML 输出显示。
# 应当在文件中，对所有代码块设为 echo=FALSE 。
library(ggplot2)
library(gridExtra)
library(GGally)
library(memisc)
m1 <- lm(I(quality)) ~ I(log(alcohol), data = redwine)
m2 <- update(m1, ~ . + volatile.acidity)
m3 <- update(m2, ~ . + citric.acid)
m4 <- update(m3, ~ . + sulphates)
mtable(m1, m2, m3, m4)
m1 <- lm(I(quality) ~ I(log(alcohol)), data = redwine)
m2 <- update(m1, ~ . + volatile.acidity)
m3 <- update(m2, ~ . + citric.acid)
m4 <- update(m3, ~ . + sulphates)
mtable(m1, m2, m3, m4)
ggplot(aes(x = volatile.acidity, y = citric.acid, color = quality),
data = redwine) +
geom_point(alpha = 0.2) +
ylim(0, quantile(redwine$citric.acid, 0.99)) +
scale_y_sqrt() +
geom_smooth(method = 'lm', se=FALSE) +
facet_wrap( ~ quality) +
labs(title = 'Citric Acid by Quality')
# 加载你最终使用的所有组件
# 在这个代码块的分析中。
# 注意，在这个代码块中，将参数 "echo" 设为假。
# This prevents the code from displaying in the knitted HTML output.这可以避免代码混入 HTML 输出显示。
# 应当在文件中，对所有代码块设为 echo=FALSE 。
library(ggplot2)
library(gridExtra)
library(GGally)
library(knitr)
ggplot(aes(x = volatile.acidity, y = citric.acid, color = quality),
data = redwine) +
geom_point(alpha = 0.2) +
ylim(0, quantile(redwine$citric.acid, 0.99)) +
scale_y_sqrt() +
geom_smooth(method = 'lm', se=FALSE) +
facet_wrap( ~ quality) +
labs(title = 'Citric Acid by Quality')
?labs
ggplot(aes(x = alcohol, y = density, color = quality),
data = redwine) +
geom_point(alpha = 0.2) +
scale_x_log10() +
geom_smooth(method = 'lm', se=FALSE) +
labs(y = '(density g/cm^3)' ,title = 'Density by Quality')
ggplot(aes(x = alcohol, y = density, color = quality),
data = redwine) +
geom_point(alpha = 0.2) +
scale_x_log10() +
geom_smooth(method = 'lm', se=FALSE) +
labs(x = 'alcohol (% by volume)',
y = 'density (g/cm^3)',
title = 'Density by Quality')
ggplot(aes(x = volatile.acidity, y = citric.acid, color = quality),
data = redwine) +
geom_point(alpha = 0.2) +
ylim(0, quantile(redwine$citric.acid, 0.99)) +
scale_y_sqrt() +
geom_smooth(method = 'lm', se=FALSE) +
facet_wrap( ~ quality) +
labs(title = 'Citric Acid by Quality')
ggplot(aes(x = volatile.acidity, y = citric.acid, color = quality),
data = redwine) +
geom_point(alpha = 0.2) +
ylim(0, quantile(redwine$citric.acid, 0.99)) +
scale_y_sqrt() +
geom_smooth(method = 'lm', se=FALSE) +
facet_wrap( ~ quality) +
labs(x = 'volatile acidity (acetic acid - g / dm^3)',
y = 'citric acid (g / dm^3)',
title = 'Citric Acid by Quality')
p1 <- ggplot(data=redwine, aes(x = quality, y = alcohol)) +
geom_jitter( alpha = 0.2, color = 'orange') +
geom_boxplot(alpha = 0.2) +
ylim(8, quantile(redwine$alcohol, 0.99)) +
scale_y_log10() +
stat_summary(fun.y = "mean",
geom = "point",
shape = 4) +
labs(title = 'Alcohol(log10) by Quality')
p2 <- ggplot(data=redwine, aes(x = quality, y = volatile.acidity)) +
geom_jitter( alpha = 0.2, color = 'orange') +
geom_boxplot(alpha = 0.2) +
ylim(0, quantile(redwine$volatile.acidity, 0.99)) +
stat_summary(fun.y = "mean",
geom = "point",
shape = 4) +
labs(title = 'Volatile acidity by Quality')
p3 <- ggplot(data=redwine, aes(x = quality, y = citric.acid)) +
geom_jitter( alpha = 0.2, color = 'orange') +
geom_boxplot(alpha = 0.2) +
ylim(0.001, quantile(redwine$citric.acid, 0.99)) +
stat_summary(fun.y = "mean",
geom = "point",
shape = 4) +
labs(title = 'Citric acid by Quality')
p4 <- ggplot(data=redwine, aes(x = quality, y = sulphates)) +
geom_jitter( alpha = 0.2, color = 'orange') +
geom_boxplot(alpha = 0.2) +
ylim(0.3, quantile(redwine$sulphates, 0.99)) +
scale_y_log10() +
stat_summary(fun.y = "mean",
geom = "point",
shape = 4) +
labs(title = 'Sulphates(log10) by Quality')
grid.arrange(p1, p2, p3, p4, ncol = 2)
p1 <- ggplot(data=redwine, aes(x = quality, y = alcohol)) +
geom_jitter( alpha = 0.2, color = 'orange') +
geom_boxplot(alpha = 0.2) +
ylim(8, quantile(redwine$alcohol, 0.99)) +
scale_y_log10() +
stat_summary(fun.y = "mean",
geom = "point",
shape = 4) +
labs(title = 'Alcohol(log10) by Quality')
p2 <- ggplot(data=redwine, aes(x = quality, y = volatile.acidity)) +
geom_jitter( alpha = 0.2, color = 'orange') +
geom_boxplot(alpha = 0.2) +
ylim(0, quantile(redwine$volatile.acidity, 0.99)) +
stat_summary(fun.y = "mean",
geom = "point",
shape = 4) +
labs(y = 'volatile acidity (g / dm^3)', title = 'Volatile acidity by Quality')
p3 <- ggplot(data=redwine, aes(x = quality, y = citric.acid)) +
geom_jitter( alpha = 0.2, color = 'orange') +
geom_boxplot(alpha = 0.2) +
ylim(0.001, quantile(redwine$citric.acid, 0.99)) +
stat_summary(fun.y = "mean",
geom = "point",
shape = 4) +
labs(title = 'Citric acid by Quality')
p4 <- ggplot(data=redwine, aes(x = quality, y = sulphates)) +
geom_jitter( alpha = 0.2, color = 'orange') +
geom_boxplot(alpha = 0.2) +
ylim(0.3, quantile(redwine$sulphates, 0.99)) +
scale_y_log10() +
stat_summary(fun.y = "mean",
geom = "point",
shape = 4) +
labs(title = 'Sulphates(log10) by Quality')
grid.arrange(p1, p2, p3, p4, ncol = 2)
p1 <- ggplot(data=redwine, aes(x = quality, y = alcohol)) +
geom_jitter( alpha = 0.2, color = 'orange') +
geom_boxplot(alpha = 0.2) +
ylim(8, quantile(redwine$alcohol, 0.99)) +
scale_y_log10() +
stat_summary(fun.y = "mean",
geom = "point",
shape = 4) +
labs(y = 'alcohol (% by volume)', title = 'Alcohol(log10) by Quality')
p2 <- ggplot(data=redwine, aes(x = quality, y = volatile.acidity)) +
geom_jitter( alpha = 0.2, color = 'orange') +
geom_boxplot(alpha = 0.2) +
ylim(0, quantile(redwine$volatile.acidity, 0.99)) +
stat_summary(fun.y = "mean",
geom = "point",
shape = 4) +
labs(y = 'volatile acidity (g / dm^3)', title = 'Volatile acidity by Quality')
p3 <- ggplot(data=redwine, aes(x = quality, y = citric.acid)) +
geom_jitter( alpha = 0.2, color = 'orange') +
geom_boxplot(alpha = 0.2) +
ylim(0.001, quantile(redwine$citric.acid, 0.99)) +
stat_summary(fun.y = "mean",
geom = "point",
shape = 4) +
labs(y = 'citric acid (g / dm^3)', title = 'Citric acid by Quality')
p4 <- ggplot(data=redwine, aes(x = quality, y = sulphates)) +
geom_jitter( alpha = 0.2, color = 'orange') +
geom_boxplot(alpha = 0.2) +
ylim(0.3, quantile(redwine$sulphates, 0.99)) +
scale_y_log10() +
stat_summary(fun.y = "mean",
geom = "point",
shape = 4) +
labs(y = 'sulphates (g / dm^3)', title = 'Sulphates(log10) by Quality')
grid.arrange(p1, p2, p3, p4, ncol = 2)
ggplot(aes(x = volatile.acidity, y = citric.acid, color = quality),
data = redwine) +
geom_point(alpha = 0.2) +
ylim(0, quantile(redwine$citric.acid, 0.99)) +
#scale_y_sqrt() +
geom_smooth(method = 'lm', se=FALSE) +
facet_wrap( ~ quality) +
labs(x = 'volatile acidity (acetic acid - g / dm^3)',
y = 'citric acid (g / dm^3)',
title = 'Citric Acid by Quality')
ggplot(aes(x = volatile.acidity, y = citric.acid, color = quality),
data = redwine) +
geom_point(alpha = 0.2) +
ylim(0, quantile(redwine$citric.acid, 0.99)) +
scale_y_sqrt() +
geom_smooth(method = 'lm', se=FALSE) +
facet_wrap( ~ quality) +
labs(x = 'volatile acidity (acetic acid - g / dm^3)',
y = 'citric acid (g / dm^3)',
title = 'Citric Acid(sqrt) by Quality')
ggplot(aes(x = volatile.acidity, y = citric.acid, color = quality),
data = redwine) +
geom_point(alpha = 0.2) +
ylim(0, quantile(redwine$citric.acid, 0.99)) +
scale_y_sqrt() +
geom_smooth(method = 'lm', se=FALSE) +
facet_wrap( ~ quality) +
labs(x = 'volatile acidity (acetic acid - g / dm^3)',
y = 'citric acid (g / dm^3)',
title = 'Citric Acid(sqrt) by Quality')
ggplot(aes(citric.acid), data = redwine) +
geom_histogram(bins = 30) +
xlim(0, quantile(redwine$citric.acid, 0.99)) +
scale_x_sqrt()
ggplot(aes(citric.acid), data = redwine) +
geom_histogram(bins = 30) +
xlim(0.001, quantile(redwine$citric.acid, 0.99)) +
scale_x_sqrt()
