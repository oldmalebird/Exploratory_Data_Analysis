shape = 4)
ggplot(data=redwine, aes(x = quality, y = density)) +
geom_jitter( alpha = 0.2, color = 'orange') +
geom_boxplot(alpha = 0.2) +
ylim(0, quantile(redwine$density, 0.99)) +
stat_summary(fun.y = "mean",
geom = "point",
shape = 4)
ggplot(data=redwine, aes(x = quality, y = density)) +
geom_jitter( alpha = 0.2, color = 'orange') +
geom_boxplot(alpha = 0.2) +
ylim(0.99, quantile(redwine$density, 0.99)) +
stat_summary(fun.y = "mean",
geom = "point",
shape = 4)
ggplot(data=redwine, aes(x = quality, y = free.sulfur.dioxide)) +
geom_jitter( alpha = 0.2, color = 'orange') +
geom_boxplot(alpha = 0.2) +
ylim(1, quantile(redwine$free.sulfur.dioxide, 0.99)) +
stat_summary(fun.y = "mean",
geom = "point",
shape = 4)
ggplot(data=redwine, aes(x = quality, y = total.sulfur.dioxide)) +
geom_jitter( alpha = 0.2, color = 'orange') +
geom_boxplot(alpha = 0.2) +
ylim(0.99, quantile(redwine$total.sulfur.dioxide, 0.99)) +
stat_summary(fun.y = "mean",
geom = "point",
shape = 4)
ggplot(data=redwine, aes(x = quality, y = sulphates)) +
geom_jitter( alpha = 0.2, color = 'orange') +
geom_boxplot(alpha = 0.2) +
ylim(0.99, quantile(redwine$sulphates, 0.99)) +
stat_summary(fun.y = "mean",
geom = "point",
shape = 4)
ggplot(data=wine, aes(x=quality, y=citric.acid)) +
geom_jitter( alpha = .3) +
geom_boxplot(alpha = .5,color = 'blue') +
stat_summary(fun.y = "mean",
geom = "point",
color = "red",
shape = 8,
size = 4)
ggplot(data=wine, aes(x=quality, y=residual.sugar)) +
geom_jitter( alpha = .3) +
geom_boxplot(alpha = .5,color = 'blue') +
scale_y_continuous(lim = c(0,5)) +
stat_summary(fun.y = "mean",
geom = "point",
color = "red",
shape = 8,
size = 4)
ggplot(data=wine, aes(x=quality, y=chlorides)) +
geom_jitter( alpha = .3) +
geom_boxplot(alpha = .5,color = 'blue') +
scale_y_continuous(lim = c(0,0.2)) +
stat_summary(fun.y = "mean",
geom = "point",
color = "red",
shape = 8,
size = 4)
ggplot(data=wine, aes(x=quality, y=free.sulfur.dioxide)) +
geom_jitter( alpha = .3) +
geom_boxplot(alpha = .5,color = 'blue') +
scale_y_continuous(lim = c(0,40)) +
stat_summary(fun.y = "mean",
geom = "point",
color = "red",
shape = 8,
size = 4)
ggplot(data=wine, aes(x=quality, y=total.sulfur.dioxide)) +
geom_jitter( alpha = .3) +
geom_boxplot(alpha = .5,color = 'blue') +
scale_y_continuous(lim = c(0,150)) +
stat_summary(fun.y = "mean",
geom = "point",
color = "red",
shape = 8,
size = 4)
ggplot(data=wine, aes(x=quality, y=density)) +
geom_jitter( alpha = .3) +
geom_boxplot(alpha = .5,color = 'blue') +
stat_summary(fun.y = "mean",
geom = "point",
color = "red",
shape = 8,
size = 4)
ggplot(data=wine, aes(x=quality, y=pH)) +
geom_jitter( alpha = .3) +
geom_boxplot(alpha = .5,color = 'blue') +
stat_summary(fun.y = "mean",
geom = "point",
color = "red",
shape = 8,
size = 4)
ggplot(data = wine, aes(x = fixed.acidity, y = pH)) +
geom_point(alpha = 0.3) +
scale_x_log10(breaks=seq(5,15,1)) +
xlab("Fixed Acidity in Log Scale") +
geom_smooth(method="lm")
ggplot(data = wine, aes(x = volatile.acidity, y = pH)) +
geom_point(alpha = 0.3) +
scale_x_log10(breaks=seq(.1,1,.1)) +
xlab("Volatile Acidity in Log Scale") +
geom_smooth(method="lm")
ggplot(data = subset(wine, citric.acid > 0), aes(x = citric.acid, y = pH)) +
geom_point(alpha = 0.3) +
scale_x_log10() +
xlab("Citric Acid in Log Scale") +
geom_smooth(method="lm")
simpsons <- Simpsons(volatile.acidity, pH, data=wine)
ggplot(data=wine, aes(x=quality, y=sulphates)) +
geom_jitter( alpha = .3) +
geom_boxplot(alpha = .5,color = 'blue') +
scale_y_continuous(lim = c(0.25,1)) +
stat_summary(fun.y = "mean",
geom = "point",
color = "red",
shape = 8,
size = 4)
ggplot(data=wine, aes(x=quality, y=alcohol)) +
geom_jitter( alpha = .3) +
geom_boxplot(alpha = .5,color = 'blue') +
stat_summary(fun.y = "mean",
geom = "point",
color = "red",
shape = 8,
size = 4)
alcoholQualityLinearModel <- lm(as.numeric(quality) ~ alcohol,
data = wine)
summary(alcoholQualityLinearModel)
simple_cor_test <- function(x, y) {
return(cor.test(x, as.numeric(y))$estimate)
}
correlations <- c(
simple_cor_test(wine$fixed.acidity, wine$quality),
simple_cor_test(wine$volatile.acidity, wine$quality),
simple_cor_test(wine$citric.acid, wine$quality),
simple_cor_test(log10(wine$residual.sugar), wine$quality),
simple_cor_test(log10(wine$chlorides), wine$quality),
simple_cor_test(wine$free.sulfur.dioxide, wine$quality),
simple_cor_test(wine$total.sulfur.dioxide, wine$quality),
simple_cor_test(wine$density, wine$quality),
simple_cor_test(wine$pH, wine$quality),
simple_cor_test(log10(wine$sulphates), wine$quality),
simple_cor_test(wine$alcohol, wine$quality))
names(correlations) <- c('fixed.acidity', 'volatile.acidity', 'citric.acid',
'log10.residual.sugar',
'log10.chlordies', 'free.sulfur.dioxide',
'total.sulfur.dioxide', 'density', 'pH',
'log10.sulphates', 'alcohol')
correlations
ggplot(data=redwine, aes(x = quality, y = citric.acid)) +
geom_jitter( alpha = 0.2, color = 'orange') +
geom_boxplot(alpha = 0.2) +
ylim(0.001, quantile(redwine$citric.acid, 0.99)) +
stat_summary(fun.y = "mean",
geom = "point",
shape = 4)
ggplot(data=wine, aes(y=alcohol, x=quality)) +
geom_jitter(alpha = .3)  +
geom_boxplot(alpha = .5,color = 'blue') +
stat_summary(fun.y = "mean",
geom = "point",
color = "red",
shape = 8,
size = 4) +
xlab("Quality") +
ggtitle("Influence of alcohol on wine quality")
ggplot(data = wine,
aes(y = sulphates, x = alcohol,
color = quality)) +
geom_point(alpha = 0.8, size = 1) +
geom_smooth(method = "lm", se = FALSE,size=1)  +
scale_y_continuous(limits=c(0.3,1.5)) +
ylab("potassium sulphate (g/dm3)") +
xlab("Alcohol Percentage") +
scale_color_brewer(type='seq',
guide=guide_legend(title='Quality')) +
ggtitle("Alcohol and sulphates over wine quality")
df <- data.frame(
test_data$quality,
predict(m5, test_data) - as.numeric(test_data$quality)
)
knitr::opts_chunk$set(echo = TRUE)
#Load all the required libraries
library("ggplot2")
library("dplyr")
library("gridExtra")
#library(Simpsons)
library(GGally)
library(memisc)
#Load all the required libraries
library("ggplot2")
library("dplyr")
library("gridExtra")
#library(Simpsons)
library(GGally)
#library(memisc)
library(pander)
#Load all the required libraries
library("ggplot2")
library("dplyr")
library("gridExtra")
#library(Simpsons)
library(GGally)
#library(memisc)
#library(pander)
#library(corrplot)
knitr::opts_chunk$set(echo = TRUE)
#Load all the required libraries
library("ggplot2")
library("dplyr")
library("gridExtra")
#library(Simpsons)
library(GGally)
#library(memisc)
#library(pander)
#library(corrplot)
#Loading the csv file
wine <- read.csv('wineQualityReds.csv')
#Transforming Quality from an Integer to a Factor
wine$quality <- factor(wine$quality, ordered = T)
#Creating a new Factored Variable called 'Rating'
wine$rating <- ifelse(wine$quality < 5, 'bad', ifelse(
wine$quality < 7, 'average', 'good'))
wine$rating <- ordered(wine$rating,
levels = c('bad', 'average', 'good'))
str(wine)
summary(wine)
ggplot(data = wine, aes(x = quality)) +
geom_bar(width = 1, color = 'black',fill = I('orange'))
ggplot(data = wine, aes(x = rating)) +
geom_bar(width = 1, color = 'black',fill = I('blue'))
grid.arrange(ggplot(wine, aes( x = 1, y = fixed.acidity ) ) +
geom_jitter(alpha = 0.1 ) +
geom_boxplot(alpha = 0.2, color = 'red' ) +
scale_y_continuous(lim = c(4,14)),
ggplot(data = wine, aes(x = fixed.acidity)) +
geom_histogram(binwidth = 1, color = 'black',fill = I('orange')) +
scale_x_continuous(lim = c(4,14)),ncol = 2)
grid.arrange(ggplot(wine, aes( x = 1, y = volatile.acidity ) ) +
geom_jitter(alpha = 0.1 ) +
geom_boxplot(alpha = 0.2, color = 'red' ) +
scale_y_continuous(lim = c(0,1)),
ggplot(data = wine, aes(x = volatile.acidity)) +
geom_histogram(binwidth = 0.05, color = 'black',fill = I('orange')) +
scale_x_continuous(lim = c(0,1)), ncol = 2)
grid.arrange(ggplot(wine, aes( x = 1, y = citric.acid )) +
geom_jitter(alpha = 0.1 ) +
geom_boxplot(alpha = 0.2, color = 'red' ),
ggplot(data = wine, aes(x = citric.acid)) +
geom_histogram(binwidth = 0.08, color = 'black',fill = I('orange')) +
scale_x_continuous(breaks = seq(0,1,0.1), lim = c(0,1)), ncol = 2)
grid.arrange(ggplot(wine, aes( x = 1, y = residual.sugar )) +
geom_jitter(alpha = 0.1 ) +
geom_boxplot(alpha = 0.2, color = 'red' ) +
scale_y_continuous(lim = c(1,8)),
ggplot(data = wine, aes(x = residual.sugar)) +
geom_histogram(binwidth = 0.1, color = 'black',fill = I('orange')) +
scale_x_continuous(lim = c(1,8)), ncol = 2)
grid.arrange(ggplot(wine, aes( x = 1, y = chlorides )) +
geom_jitter(alpha = 0.1 ) +
geom_boxplot(alpha = 0.2, color = 'red' ) +
scale_y_continuous(lim = c(0,0.25)),
ggplot(data = wine, aes(x = chlorides)) +
geom_histogram(binwidth = 0.01, color = 'black',fill = I('orange')) +
scale_x_continuous(lim = c(0,0.25)), ncol = 2)
grid.arrange(ggplot(wine, aes( x = 1, y = free.sulfur.dioxide )) +
geom_jitter(alpha = 0.1 ) +
geom_boxplot(alpha = 0.2, color = 'red' ) +
scale_y_continuous(lim = c(0,45)),
ggplot(data = wine, aes(x = free.sulfur.dioxide)) +
geom_histogram(binwidth = 1, color = 'black',fill = I('orange')) +
scale_x_continuous(breaks = seq(0,80,5), lim = c(0,45)), ncol = 2)
grid.arrange(ggplot(wine, aes( x = 1, y = total.sulfur.dioxide )) +
geom_jitter(alpha = 0.1 ) +
geom_boxplot(alpha = 0.2, color = 'red' ) +
scale_y_continuous(lim = c(0,180)),
ggplot(data = wine, aes(x = total.sulfur.dioxide)) +
geom_histogram(binwidth = 5, color = 'black',fill = I('orange')) +
scale_x_continuous(lim = c(0,180)), ncol = 2)
grid.arrange(ggplot(wine, aes( x = 1, y = density)) +
geom_jitter(alpha = 0.1 ) +
geom_boxplot(alpha = 0.2, color = 'red' ),
ggplot(data = wine, aes(x = density)) +
geom_histogram(binwidth = 0.001, color = 'black',fill = I('orange')), ncol = 2)
grid.arrange(ggplot(wine, aes( x = 1, y = pH)) +
geom_jitter(alpha = 0.1 ) +
geom_boxplot(alpha = 0.2, color = 'red' ),
ggplot(data = wine, aes(x = pH)) +
geom_histogram(binwidth = 0.1, color = 'black',fill = I('orange')), ncol = 2)
grid.arrange(ggplot(wine, aes( x = 1, y = alcohol)) +
geom_jitter(alpha = 0.1 ) +
geom_boxplot(alpha = 0.2, color = 'red' ) +
scale_y_continuous(lim = c(8,14)),
ggplot(data = wine, aes(x = alcohol)) +
geom_histogram(binwidth = 0.1, color = 'black',fill = I('orange')) +
scale_x_continuous(lim = c(8,14)), ncol = 2)
grid.arrange(ggplot(wine, aes( x = 1, y = sulphates)) +
geom_jitter(alpha = 0.1 ) +
geom_boxplot(alpha = 0.2, color = 'red' ) +
scale_y_continuous(lim = c(0.3,1.6)),
ggplot(data = wine, aes(x = sulphates)) +
geom_histogram(binwidth = 0.1, color = 'black',fill = I('orange')) +
scale_x_continuous(lim = c(0.3,1.6)), ncol = 2)
set.seed(1000)
redwine_subset <- redwine[c(2:13)]
ggpairs(redwine_subset[sample.int(nrow(redwine_subset), 1000), ])
ggsave('散点矩阵图.png')
head(redwine)
# 加载数据
redwine <- read.csv('wineQualityreds.csv')
set.seed(1000)
redwine_subset <- redwine[c(2:13)]
ggpairs(redwine_subset[sample.int(nrow(redwine_subset), 1000), ])
ggsave('散点矩阵图.png')
redwine$quality <- factor(redwine$quality, ordered = T)
ggplot(data=redwine, aes(x = quality, y = fixed.acidity)) +
geom_jitter( alpha = 0.2, color = 'orange') +
geom_boxplot(alpha = 0.2) +
ylim(3, quantile(redwine$fixed.acidity, 0.99)) +
stat_summary(fun.y = "mean",
geom = "point",
shape = 4)
redwine$quality <- factor(redwine$quality, ordered = T)
ggplot(data=redwine, aes(x = quality, y = fixed.acidity)) +
geom_jitter( alpha = 0.2, color = 'orange') +
geom_boxplot(alpha = 0.2) +
ylim(3, quantile(redwine$fixed.acidity, 0.99)) +
stat_summary(fun.y = "mean",
geom = "point",
shape = 4)
library(ggplot2)
library(dplyr)
library(knitr)
source("https://raw.githubusercontent.com/briatte/ggcorr/master/ggcorr.R")
wine <- read.csv('wineQualityReds.csv')
summary(wine$quality_f)
summary(wine$quality)
wine$quality_f <- factor(wine$quality,
labels = c('3','4','5','6','7','8'))
str(wine)
names(wine)
summary(wine)
table(wine$quality)
qplot(x = quality, data = wine,
binwidth=0.3,
fill=I('grey'),
col=I('black'))
summary(wine$alcohol)
qplot(x = alcohol, data = wine,
binwidth = 0.1)+
scale_x_continuous(breaks = seq(8, 15, 0.5))
by(wine$alcohol, wine$quality, summary)
qplot(x=alcohol, data=wine)+
facet_wrap(~quality)
qplot(x=alcohol, data=wine,
binwidth=0.3)+
facet_wrap(~quality)
quality_group <- group_by(wine,quality)
wine.alco_by_quality <- summarise(quality_group,
alco_mean=mean(alcohol),
alco_median=median(alcohol),
n=n())
head(wine.alco_by_quality)
by(wine$alcohol,wine$quality,summary)
ggplot(aes(x=quality_f, y=alcohol), data= wine)+
geom_boxplot()+
scale_y_continuous(breaks=seq(8,13,1),limits = c(9,13))
summary(wine$citric.acid)
qplot(x = citric.acid, data = wine,
binwidth=0.01)
subset(wine, citric.acid>=1)
summary(wine$fixed.acidity)
qplot(x = fixed.acidity, data=wine,
binwidth=0.1,
fill=I('grey'),
color=I('black'))+
scale_x_continuous(breaks=seq(4,16,1))
summary(wine$volatile.acidity)
qplot(x = volatile.acidity, data=wine,
binwidth=0.01,
fill=I('grey'),
color=I('black'))+
scale_x_continuous(breaks=seq(0,2,0.1))
summary(wine$residual.sugar)
qplot(x=residual.sugar, data=wine,
binwidth=0.1)+
scale_x_continuous(breaks=seq(0,16,1))
summary(wine$chlorides)
qplot(x=chlorides, data=wine,
binwidth=0.005)+
scale_x_continuous(breaks=seq(0,0.65,0.05))
summary(wine$density)
qplot(x=density, data=wine,
binwidth=0.0001)+
scale_x_continuous(breaks=seq(0.99,2,0.001))
summary(wine$pH)
qplot(x=pH, data=wine,
binwidth=0.01)
quality_bucket = cut(wine$quality,3,labels=c('Low (Rating 3 - 4)','Medium (Rating 5 - 6) ','High (Rating 7 - 8)'))
table(quality_bucket)
qplot(x=quality_bucket,data=wine)
ggcorr(wine)
ggplot(aes(x=alcohol,y=quality),data=wine)+
geom_jitter(alpha=0.3,color='orange')+
geom_smooth(method=lm,se=FALSE,size=1)+
scale_x_continuous(breaks=seq(9,14,1))+
xlim(9,14)
ggplot(aes(x=quality_f, y=alcohol,color=quality_f), data= wine)+
geom_boxplot()+
geom_jitter(alpha=0.3,size=1)+
scale_color_brewer(type="seq",
guide=guide_legend(title='Quality Groups'))
cor.test(wine$alcohol, wine$quality)
ggplot(aes(x=citric.acid,y=density),data=wine)+
geom_point(alpha=0.3,size=1)+
geom_smooth(method=lm, se=FALSE, size=0.6)
cor.test(wine$citric.acid,wine$density)
ggplot(aes(x=pH,y=alcohol),data=wine)+
geom_point(alpha=0.3)+
coord_trans(x='sqrt')+
geom_smooth(method=lm,se=FALSE,size=1)
cor.test(wine$alcohol,wine$pH)
ggplot(aes(x=alcohol,y=density),data=wine)+
geom_point(alpha=0.3, color='orange')+
coord_trans(y='sqrt')+
geom_smooth(method=lm,se=FALSE,size=1)
cor.test(wine$alcohol,wine$density)
ggplot(aes(x=citric.acid,y=quality),data=wine)+
geom_jitter(alpha=0.3,color='orange')+
geom_smooth(method=lm,se=FALSE,size=1)
cor.test(wine$citric.acid,wine$quality)
ggplot(aes(x=quality_f,y=citric.acid),data=wine)+
geom_boxplot()+
ylim(0,0.6)
by(wine$citric.acid,wine$quality,summary)
by(wine$citric.acid,wine$quality,summary)
wine.citric_by_quality <- summarise(quality_group,
citric_mean=mean(citric.acid),
n())
head(wine.citric_by_quality)
ggplot(aes(x=quality,y=citric_mean), data=wine.citric_by_quality)+
geom_jitter(color='blue')+
geom_smooth(method=lm, color='grey')
ggplot(aes(x=citric.acid,y=alcohol),data=subset(wine,citric.acid>0))+
geom_jitter(alpha=0.3,color='orange')+
scale_y_log10()+
geom_smooth(method=lm,se=FALSE,size=1)
cor.test(wine$citric.acid,wine$alcohol)
ggplot(aes(x=density, y=pH),data=wine)+
geom_point(alpha=0.3,color='orange')+
geom_smooth(method=lm,se=FALSE,size=1)
cor.test(wine$pH, wine$density)
ggplot(aes(x=citric.acid,y=pH),data=wine)+
geom_point(color='orange',alpha=0.3)+
geom_smooth(method=lm,se=FALSE,size=1)
cor.test(wine$citric.acid,wine$pH)
ggplot(aes(x=alcohol, y=density, color=quality_f),
data = wine) +
geom_point(alpha=0.2, size=1) +
geom_smooth(method ="lm", se=FALSE,size=0.6)  +
scale_color_brewer(type='seq',
guide=guide_legend(title='Quality'))
ggplot(aes(x=alcohol,y=density,color=quality_bucket),data=wine)+
geom_point(alpha=0.2,size=1)+
geom_smooth(linetype=1,method=lm,size=0.6)+
scale_color_brewer(type="seq",
guide=guide_legend(title='Quality Groups'))
ggplot(aes(x=density, y=pH,color=quality_bucket),data=wine)+
geom_point(alpha=0.2,size=1)+
geom_smooth(method=lm,se=FALSE,size=0.6)+
scale_color_brewer(type="seq",
guide=guide_legend(title = 'Quality Groups'))
ggplot(aes(x=citric.acid,y=pH,color=quality_bucket),data=wine)+
geom_point(alpha=0.3,size=1)+
geom_smooth(method=lm, se=FALSE, size=0.6)+
scale_color_brewer(type="seq",
guide=guide_legend(title='Quality Groups'))
ggplot(aes(x=citric.acid,y=density,color=quality_bucket),data=wine)+
geom_point(alpha=0.3,size=1)+
geom_smooth(method=lm, se=FALSE, size=0.6)+
scale_color_brewer(type="seq",
guide=guide_legend(title='Quality Groups'))
m1 <- lm(wine$quality ~ wine$alcohol)
m2 <- lm(wine$quality ~ wine$alcohol+wine$density)
m3 <- lm(wine$quality ~ wine$alcohol+wine$density+wine$citric.acid)
m4 <- lm(wine$quality ~ wine$alcohol+wine$density+wine$citric.acid+wine$pH)
summary(m1)$r.squared
summary(m2)$r.squared
summary(m3)$r.squared
summary(m4)$r.squared
m5 <- lm(wine$density ~ wine$alcohol)
summary(m5)$r.squared
ggplot(aes(x=alcohol,y=density,color=quality_bucket),data=wine)+
geom_point(alpha=0.2,size=1)+
geom_smooth(linetype=1,method=lm,size=0.6,se=FALSE)+
scale_color_brewer(type="seq",
guide=guide_legend(title='Quality Groups'))+
labs(x="Alcohol (% by volume)",
y="Density (g / cm^3)",
title="Density and Alcohol in Quality Groups")
ggplot(aes(x=quality_f, y=alcohol,color=quality_f), data= wine)+
geom_boxplot()+
geom_jitter(alpha=0.3,size=1)+
scale_color_brewer(type="seq",
guide=guide_legend(title='Quality Groups'))+
labs(x="Quality",
y="Alcohol (% by volume)",
title="Alcohol and Quality")
