---
output: html_document
editor_options: 
  chunk_output_type: inline
---
红葡萄酒品质分析
========================================================

```{r echo=FALSE, message=FALSE, warning=FALSE, packages}
# 加载你最终使用的所有组件
# 在这个代码块的分析中。

# 注意，在这个代码块中，将参数 "echo" 设为假。
# This prevents the code from displaying in the knitted HTML output.这可以避免代码混入 HTML 输出显示。
# 应当在文件中，对所有代码块设为 echo=FALSE 。

library(ggplot2)
library(gridExtra)
library(GGally)
```

```{r echo=FALSE, Load_the_Data}
# 加载数据
redwine <- read.csv('wineQualityreds.csv')
```

# 单变量绘图选择
```{r echo=FALSE, Univariate_Plots}
str(redwine)
```

```{r echo=FALSE, Univariate_Plots}
summary(redwine)
```

```{r echo=FALSE, Univariate_Plots}
#redwine$quality <- factor(redwine$quality, ordered = T)
table(redwine$quality)
```

```{r}
ggplot(aes(quality), data = redwine) +
  geom_histogram(binwidth = 0.5)
```
葡萄酒质量评分介于3-8之间，主要分布在5-7，基本为正态分布。

## 酸度
```{r echo=FALSE, Univariate_Plots}
ggplot(aes(fixed.acidity), data = redwine) +
  geom_histogram(bins = 30)
```

```{r echo=FALSE, Univariate_Plots}
ggplot(aes(volatile.acidity), data = redwine) +
  geom_histogram(bins = 50)
```

```{r echo=FALSE, Univariate_Plots}
ggplot(aes(citric.acid), data = redwine) +
  geom_histogram(bins = 30)
```


```{r echo=FALSE, Univariate_Plots}
table(redwine$citric.acid)
```
柠檬酸有很多0值

```{r echo=FALSE, Univariate_Plots}
ggplot(aes(pH), data = redwine) +
  geom_histogram(bins = 30)
```
大部分红葡萄酒的pH在3.0-3.6之间
## 残糖量
```{r echo=FALSE, Univariate_Plots}
ggplot(aes(residual.sugar), data = redwine) +
  geom_histogram()
```
残糖量向右倾斜，以log10转换坐标轴。
```{r echo=FALSE, Univariate_Plots}
ggplot(aes(residual.sugar), data = redwine) +
  geom_histogram() +
  scale_x_log10()
```

## 氯化物含量
```{r echo=FALSE, Univariate_Plots}
ggplot(aes(chlorides), data = redwine) +
  geom_histogram(bins = 30) +
  xlim(0, quantile(redwine$chlorides, 0.98))
```
## 硫
```{r echo=FALSE, Univariate_Plots}
ggplot(aes(free.sulfur.dioxide), data = redwine) +
  geom_histogram(bins = 30)
```
游离二氧化硫向右倾斜，以log10转换坐标轴。
```{r echo=FALSE, Univariate_Plots}
ggplot(aes(free.sulfur.dioxide), data = redwine) +
  geom_histogram() +
  scale_x_log10()
```

```{r echo=FALSE, Univariate_Plots}
ggplot(aes(total.sulfur.dioxide), data = redwine) +
  geom_histogram()
```
总二氧化硫向右倾斜，以log10转换坐标轴。
```{r echo=FALSE, Univariate_Plots}
ggplot(aes(total.sulfur.dioxide), data = redwine) +
  geom_histogram() +
  scale_x_log10()
```

```{r echo=FALSE, Univariate_Plots}
ggplot(aes(sulphates), data = redwine) +
  geom_histogram(bins = 30)
```
## 密度
```{r echo=FALSE, Univariate_Plots}
ggplot(aes(density), data = redwine) +
  geom_histogram(bins = 30)
```

## 酒精

```{r echo=FALSE, Univariate_Plots}
ggplot(aes(alcohol), data = redwine) +
  geom_histogram()
```
酒精度向右倾斜，以log10转换坐标轴。
```{r echo=FALSE, Univariate_Plots}
ggplot(aes(alcohol), data = redwine) +
  geom_histogram() +
  scale_x_log10()
```

```{r echo=FALSE, Univariate_Plots}
```


# 单变量分析

### 你的数据集结构是什么？
数据集包含13个变量，1599个观察值。


### 你的数据集内感兴趣的主要特性有哪些？
感兴趣的主要特征有红葡萄酒的酸度、二氧化硫含量和品质，是否可以通过一些红葡萄酒的理化指标来预测该酒的品质。

### 你认为数据集内哪些其他特征可以帮助你探索兴趣特点？
猜测挥发性酸度、柠檬酸、残糖、游离二氧化硫、总二氧化硫、pH、酒精度会影响红葡萄酒的品质。

### 根据数据集内已有变量，你是否创建了任何新变量？
没有。

### 在已经探究的特性中，是否存在任何异常分布？你是否对数据进行一些操作，如清洁、调整或改变数据的形式？如果是，你为什么会这样做？
残糖直方图向右倾斜，于是对x轴进行了log10转换，转换后呈现双峰。



# 双变量绘图选择
```{r echo=FALSE, Bivariate_Plots}

set.seed(1000)
redwine_subset <- redwine[c(2:13)]
ggpairs(redwine_subset[sample.int(nrow(redwine_subset), 1000), ])
ggsave('散点矩阵图.png')
```
由上图可看出：
- 酒精度、硫酸盐含量、挥发性酸、柠檬酸、总二氧化硫与红葡萄酒质量有相关性。
- 密度与酒精度有相关性。
- 柠檬酸与pH有相关性。
- 密度、pH、柠檬酸与不挥发酸有相关性。


```{r echo=FALSE, Univariate_Plots}
redwine$quality <- factor(redwine$quality, ordered = T)
ggplot(data=redwine, aes(x = quality, y = fixed.acidity)) +
  geom_jitter( alpha = 0.2, color = 'orange') +
  geom_boxplot(alpha = 0.2) +
  ylim(3, quantile(redwine$fixed.acidity, 0.99)) +
  stat_summary(fun.y = "mean", 
               geom = "point",
               shape = 4)
```

```{r echo=FALSE, Univariate_Plots}
ggplot(data=redwine, aes(x = quality, y = volatile.acidity)) +
  geom_jitter( alpha = 0.2, color = 'orange') +
  geom_boxplot(alpha = 0.2) +
  ylim(0, quantile(redwine$volatile.acidity, 0.99)) +
  stat_summary(fun.y = "mean", 
               geom = "point",
               shape = 4)
```
挥发性有机酸含量越低，红葡萄酒的品质越高。

```{r echo=FALSE, Univariate_Plots}
ggplot(data=redwine, aes(x = quality, y = citric.acid)) +
  geom_jitter( alpha = 0.2, color = 'orange') +
  geom_boxplot(alpha = 0.2) +
  ylim(0.001, quantile(redwine$citric.acid, 0.99)) +
  stat_summary(fun.y = "mean", 
               geom = "point",
               shape = 4)
```
柠檬酸含量越高，红葡萄酒的品质越高。

```{r echo=FALSE, Univariate_Plots}
ggplot(data=redwine, aes(x = quality, y = pH)) +
  geom_jitter( alpha = 0.2, color = 'orange') +
  geom_boxplot(alpha = 0.2) +
  ylim(2.5, quantile(redwine$pH, 0.99)) +
  stat_summary(fun.y = "mean", 
               geom = "point",
               shape = 4)
```

               
```{r echo=FALSE, Univariate_Plots}
ggplot(data=redwine, aes(x = quality, y = residual.sugar)) +
  geom_jitter( alpha = 0.2, color = 'orange') +
  geom_boxplot(alpha = 0.2) +
  ylim(0, quantile(redwine$residual.sugar, 0.99)) +
  stat_summary(fun.y = "mean", 
               geom = "point",
               shape = 4)
```
               
```{r echo=FALSE, Univariate_Plots}
ggplot(data=redwine, aes(x = quality, y = chlorides)) +
  geom_jitter( alpha = 0.2, color = 'orange') +
  geom_boxplot(alpha = 0.2) +
  ylim(0, quantile(redwine$chlorides, 0.99)) +
  stat_summary(fun.y = "mean", 
               geom = "point",
               shape = 4)
```
```{r echo=FALSE, Univariate_Plots}
ggplot(data=redwine, aes(x = quality, y = free.sulfur.dioxide)) +
  geom_jitter( alpha = 0.2, color = 'orange') +
  geom_boxplot(alpha = 0.2) +
  ylim(1, quantile(redwine$free.sulfur.dioxide, 0.99)) +
  stat_summary(fun.y = "mean", 
               geom = "point",
               shape = 4)
```

```{r echo=FALSE, Univariate_Plots}
ggplot(data=redwine, aes(x = quality, y = total.sulfur.dioxide)) +
  geom_jitter( alpha = 0.2, color = 'orange') +
  geom_boxplot(alpha = 0.2) +
  ylim(0.99, quantile(redwine$total.sulfur.dioxide, 0.99)) +
  stat_summary(fun.y = "mean", 
               geom = "point",
               shape = 4)
```

```{r echo=FALSE, Univariate_Plots}
ggplot(data=redwine, aes(x = quality, y = sulphates)) +
  geom_jitter( alpha = 0.2, color = 'orange') +
  geom_boxplot(alpha = 0.2) +
  ylim(0.99, quantile(redwine$sulphates, 0.99)) +
  stat_summary(fun.y = "mean", 
               geom = "point",
               shape = 4)
```

```{r echo=FALSE, Univariate_Plots}
ggplot(data=redwine, aes(x = quality, y = alcohol)) +
  geom_jitter( alpha = 0.2, color = 'orange') +
  geom_boxplot(alpha = 0.2) +
  ylim(8, quantile(redwine$alcohol, 0.99)) +
  stat_summary(fun.y = "mean", 
               geom = "point",
               shape = 4)
```
整体来讲，酒精度越高，红葡萄酒的质量越高。

# 双变量分析

### 探讨你在这部分探究中观察到的一些关系。这些感兴趣的特性与数据集内其他特性有什么区别？
- 酒精度与红葡萄酒品质呈正相关
- 挥发性酸与红葡萄酒品质呈负相关
- 柠檬酸与红葡萄酒品质呈正相关


### 你是否观察到主要特性与其他特性之间的有趣关系？
- 密度与酒精度呈负相关
- 不挥发酸与总酸度呈正相关

### 你发现最强的关系是什么？
最强的关系是酒精度与红葡萄酒品质的正相关性，二者的相关系数达



# 多变量绘图选择

```{r echo=FALSE, Multivariate_Plots}
head(redwine)
```

# 多变量分析

###  探讨你在这部分探究中观察到的一些关系。通过观察感兴趣的特性，是否存在相互促进的特性？

### 这些特性之间是否存在有趣或惊人的联系呢？

### 选项：你是否创建过数据集的任何模型？讨论你模型的优缺点。

------

# 定稿图与总结

### 绘图一
```{r echo=FALSE, Plot_One}

```

### 描述一


### 绘图二
```{r echo=FALSE, Plot_Two}

```

### 描述二


### 绘图三
```{r echo=FALSE, Plot_Three}

```

### 描述三

------

# 反思